!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("coffeescript",function(e){function i(e){return new RegExp("^(("+e.join(")|(")+"))\\b")}function y(e,i){if(e.sol()){null===i.scope.align&&(i.scope.align=!1);var l=i.scope.offset;if(e.eatSpace()){var u=e.indentation();return u>l&&"coffee"==i.scope.type?"indent":l>u?"dedent":null}l>0&&b(e,i)}if(e.eatSpace())return null;var h=e.peek();if(e.match("####"))return e.skipToEnd(),"comment";if(e.match("###"))return i.tokenize=g,i.tokenize(e,i);if("#"===h)return e.skipToEnd(),"comment";if(e.match(/^-?[0-9\.]/,!1)){var y=!1;if(e.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)&&(y=!0),e.match(/^-?\d+\.\d*/)&&(y=!0),e.match(/^-?\.\d+/)&&(y=!0),y)return"."==e.peek()&&e.backUp(1),"number";var v=!1;if(e.match(/^-?0x[0-9a-f]+/i)&&(v=!0),e.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)&&(v=!0),e.match(/^-?0(?![\dx])/i)&&(v=!0),v)return"number"}if(e.match(f))return i.tokenize=m(e.current(),!1,"string"),i.tokenize(e,i);if(e.match(d)){if("/"!=e.current()||e.match(/^.*\//,!1))return i.tokenize=m(e.current(),!0,"string-2"),i.tokenize(e,i);e.backUp(1)}return e.match(r)||e.match(o)?"operator":e.match(n)?"punctuation":e.match(p)?"atom":e.match(c)?"keyword":e.match(a)?"variable":e.match(s)?"property":(e.next(),t)}function m(i,r,n){return function(a,s){for(;!a.eol();)if(a.eatWhile(/[^'"\/\\]/),a.eat("\\")){if(a.next(),r&&a.eol())return n}else{if(a.match(i))return s.tokenize=y,n;a.eat(/['"\/]/)}return r&&(e.mode.singleLineStringErrors?n=t:s.tokenize=y),n}}function g(e,t){for(;!e.eol();){if(e.eatWhile(/[^#]/),e.match("###")){t.tokenize=y;break}e.eatWhile("#")}return"comment"}function v(t,i,r){r=r||"coffee";for(var n=0,a=!1,s=null,o=i.scope;o;o=o.prev)if("coffee"===o.type||"}"==o.type){n=o.offset+e.indentUnit;break}"coffee"!==r?(a=null,s=t.column()+t.current().length):i.scope.align&&(i.scope.align=!1),i.scope={offset:n,type:r,prev:i.scope,align:a,alignOffset:s}}function b(e,t){if(t.scope.prev){if("coffee"===t.scope.type){for(var i=e.indentation(),r=!1,n=t.scope;n;n=n.prev)if(i===n.offset){r=!0;break}if(!r)return!0;for(;t.scope.prev&&t.scope.offset!==i;)t.scope=t.scope.prev;return!1}return t.scope=t.scope.prev,!1}}function j(e,i){var r=i.tokenize(e,i),n=e.current();if("."===n)return r=i.tokenize(e,i),n=e.current(),/^\.[\w$]+$/.test(n)?"variable":t;"return"===n&&(i.dedent=!0),("->"!==n&&"=>"!==n||i.lambda||e.peek())&&"indent"!==r||v(e,i);var a="[({".indexOf(n);if(-1!==a&&v(e,i,"])}".slice(a,a+1)),l.exec(n)&&v(e,i),"then"==n&&b(e,i),"dedent"===r&&b(e,i))return t;if(a="])}".indexOf(n),-1!==a){for(;"coffee"==i.scope.type&&i.scope.prev;)i.scope=i.scope.prev;i.scope.type==n&&(i.scope=i.scope.prev)}return i.dedent&&e.eol()&&("coffee"==i.scope.type&&i.scope.prev&&(i.scope=i.scope.prev),i.dedent=!1),r}var t="error",r=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/,n=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/,a=/^[_A-Za-z$][_A-Za-z$0-9]*/,s=/^(@|this\.)[_A-Za-z$][_A-Za-z$0-9]*/,o=i(["and","or","not","is","isnt","in","instanceof","typeof"]),l=["for","while","loop","if","unless","else","switch","try","catch","finally","class"],u=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"],c=i(l.concat(u));l=i(l);var f=/^('{3}|\"{3}|['\"])/,d=/^(\/{3}|\/)/,h=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"],p=i(h),w={startState:function(e){return{tokenize:y,scope:{offset:e||0,type:"coffee",prev:null,align:!1},lastToken:null,lambda:!1,dedent:0}},token:function(e,t){var i=null===t.scope.align&&t.scope;i&&e.sol()&&(i.align=!1);var r=j(e,t);return i&&r&&"comment"!=r&&(i.align=!0),t.lastToken={style:r,content:e.current()},e.eol()&&e.lambda&&(t.lambda=!1),r},indent:function(e,t){if(e.tokenize!=y)return 0;var i=e.scope,r=t&&"])}".indexOf(t.charAt(0))>-1;if(r)for(;"coffee"==i.type&&i.prev;)i=i.prev;var n=r&&i.type===t.charAt(0);return i.align?i.alignOffset-(n?1:0):(n?i.prev:i).offset},lineComment:"#",fold:"indent"};return w}),e.defineMIME("text/x-coffeescript","coffeescript")});
