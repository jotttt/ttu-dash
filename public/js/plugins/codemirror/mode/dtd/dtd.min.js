!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("dtd",function(e){function r(e,t){return i=t,e}function n(e,t){var i=e.next();if("<"!=i||!e.eat("!")){if("<"==i&&e.eat("?"))return t.tokenize=s("meta","?>"),r("meta",i);if("#"==i&&e.eatWhile(/[\w]/))return r("atom","tag");if("|"==i)return r("keyword","seperator");if(i.match(/[\(\)\[\]\-\.,\+\?>]/))return r(null,i);if(i.match(/[\[\]]/))return r("rule",i);if('"'==i||"'"==i)return t.tokenize=o(i),t.tokenize(e,t);if(e.eatWhile(/[a-zA-Z\?\+\d]/)){var n=e.current();return null!==n.substr(n.length-1,n.length).match(/\?|\+/)&&e.backUp(1),r("tag","tag")}return"%"==i||"*"==i?r("number","number"):(e.eatWhile(/[\w\\\-_%.{,]/),r(null,null))}return e.eatWhile(/[\-]/)?(t.tokenize=a,a(e,t)):e.eatWhile(/[\w]/)?r("keyword","doindent"):void 0}function a(e,t){for(var a,i=0;null!=(a=e.next());){if(i>=2&&">"==a){t.tokenize=n;break}i="-"==a?i+1:0}return r("comment","comment")}function o(e){return function(t,i){for(var o,a=!1;null!=(o=t.next());){if(o==e&&!a){i.tokenize=n;break}a=!a&&"\\"==o}return r("string","tag")}}function s(e,t){return function(i,r){for(;!i.eol();){if(i.match(t)){r.tokenize=n;break}i.next()}return e}}var i,t=e.indentUnit;return{startState:function(e){return{tokenize:n,baseIndent:e||0,stack:[]}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t),n=t.stack[t.stack.length-1];return"["==e.current()||"doindent"===i||"["==i?t.stack.push("rule"):"endtag"===i?t.stack[t.stack.length-1]="endtag":"]"==e.current()||"]"==i||">"==i&&"rule"==n?t.stack.pop():"["==i&&t.stack.push("["),r},indent:function(e,r){var n=e.stack.length;return r.match(/\]\s+|\]/)?n-=1:">"===r.substr(r.length-1,r.length)&&("<"===r.substr(0,1)||"doindent"==i&&r.length>1||("doindent"==i?n--:">"==i&&r.length>1||"tag"==i&&">"!==r||("tag"==i&&"rule"==e.stack[e.stack.length-1]?n--:"tag"==i?n++:">"===r&&"rule"==e.stack[e.stack.length-1]&&">"===i?n--:">"===r&&"rule"==e.stack[e.stack.length-1]||("<"!==r.substr(0,1)&&">"===r.substr(0,1)?n-=1:">"===r||(n-=1)))),(null==i||"]"==i)&&n--),e.baseIndent+n*t},electricChars:"]>"}}),e.defineMIME("application/xml-dtd","dtd")});
