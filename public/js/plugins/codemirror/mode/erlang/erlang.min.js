!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMIME("text/x-erlang","erlang"),e.defineMode("erlang",function(t){function g(e,t){if(t.in_string)return t.in_string=!w(e),T(t,e,"string");if(t.in_atom)return t.in_atom=!x(e),T(t,e,"atom");if(e.eatSpace())return T(t,e,"whitespace");if(!E(t)&&e.match(/-\s*[a-zß-öø-ÿ][\wØ-ÞÀ-Öß-öø-ÿ]*/))return k(e.current(),i)?T(t,e,"type"):T(t,e,"attribute");var g=e.next();if("%"==g)return e.skipToEnd(),T(t,e,"comment");if(":"==g)return T(t,e,"colon");if("?"==g)return e.eatSpace(),e.eatWhile(m),T(t,e,"macro");if("#"==g)return e.eatSpace(),e.eatWhile(m),T(t,e,"record");if("$"==g)return"\\"!=e.next()||e.match(y)?T(t,e,"number"):T(t,e,"error");if("."==g)return T(t,e,"dot");if("'"==g){if(!(t.in_atom=!x(e))){if(e.match(/\s*\/\s*[0-9]/,!1))return e.match(/\s*\/\s*[0-9]/,!0),T(t,e,"fun");if(e.match(/\s*\(/,!1)||e.match(/\s*:/,!1))return T(t,e,"function")}return T(t,e,"atom")}if('"'==g)return t.in_string=!w(e),T(t,e,"string");if(/[A-Z_Ø-ÞÀ-Ö]/.test(g))return e.eatWhile(m),T(t,e,"variable");if(/[a-z_ß-öø-ÿ]/.test(g)){if(e.eatWhile(m),e.match(/\s*\/\s*[0-9]/,!1))return e.match(/\s*\/\s*[0-9]/,!0),T(t,e,"fun");var j=e.current();return k(j,r)?T(t,e,"keyword"):k(j,o)?T(t,e,"operator"):e.match(/\s*\(/,!1)?!k(j,p)||":"==E(t).token&&"erlang"!=E(t,2).token?k(j,h)?T(t,e,"guard"):T(t,e,"function"):T(t,e,"builtin"):k(j,o)?T(t,e,"operator"):":"==Q(e)?"erlang"==j?T(t,e,"builtin"):T(t,e,"function"):k(j,["true","false"])?T(t,e,"boolean"):k(j,["true","false"])?T(t,e,"boolean"):T(t,e,"atom")}var C=/[0-9]/,S=/[0-9a-zA-Z]/;return C.test(g)?(e.eatWhile(C),e.eat("#")?e.eatWhile(S)||e.backUp(1):e.eat(".")&&(e.eatWhile(C)?e.eat(/[eE]/)&&(e.eat(/[-+]/)?e.eatWhile(C)||e.backUp(2):e.eatWhile(C)||e.backUp(1)):e.backUp(1)),T(t,e,"number")):v(e,u,c)?T(t,e,"open_paren"):v(e,f,d)?T(t,e,"close_paren"):b(e,n,a)?T(t,e,"separator"):b(e,s,l)?T(t,e,"operator"):T(t,e,null)}function v(e,t,i){if(1==e.current().length&&t.test(e.current())){for(e.backUp(1);t.test(e.peek());)if(e.next(),k(e.current(),i))return!0;e.backUp(e.current().length-1)}return!1}function b(e,t,i){if(1==e.current().length&&t.test(e.current())){for(;t.test(e.peek());)e.next();for(;0<e.current().length;){if(k(e.current(),i))return!0;e.backUp(1)}e.next()}return!1}function w(e){return j(e,'"',"\\")}function x(e){return j(e,"'","\\")}function j(e,t,i){for(;!e.eol();){var r=e.next();if(r==t)return!0;r==i&&e.next()}return!1}function Q(e){var t=e.match(/([\n\s]+|%[^\n]*\n)*(.)/,!1);return t?t.pop():""}function k(e,t){return-1<t.indexOf(e)}function T(e,t,i){switch(N(e,S(i,t)),i){case"atom":return"atom";case"attribute":return"attribute";case"boolean":return"atom";case"builtin":return"builtin";case"close_paren":return null;case"colon":return null;case"comment":return"comment";case"dot":return null;case"error":return"error";case"fun":return"meta";case"function":return"tag";case"guard":return"property";case"keyword":return"keyword";case"macro":return"variable-2";case"number":return"number";case"open_paren":return null;case"operator":return"operator";case"record":return"bracket";case"separator":return null;case"string":return"string";case"type":return"def";case"variable":return"variable";default:return null}}function C(e,t,i,r){return{token:e,column:t,indent:i,type:r}}function S(e,t){return C(t.current(),t.column(),t.indentation(),e)}function _(e){return C(e,0,0,e)}function E(e,t){var i=e.tokenStack.length,r=t?t:1;return r>i?!1:e.tokenStack[i-r]}function N(e,t){"comment"!=t.type&&"whitespace"!=t.type&&(e.tokenStack=A(e.tokenStack,t),e.tokenStack=O(e.tokenStack))}function A(e,t){var i=e.length-1;return i>0&&"record"===e[i].type&&"dot"===t.type?e.pop():i>0&&"group"===e[i].type?(e.pop(),e.push(t)):e.push(t),e}function O(e){var t=e.length-1;if("dot"===e[t].type)return[];if("fun"===e[t].type&&"fun"===e[t-1].token)return e.slice(0,t-1);switch(e[e.length-1].token){case"}":return D(e,{g:["{"]});case"]":return D(e,{i:["["]});case")":return D(e,{i:["("]});case">>":return D(e,{i:["<<"]});case"end":return D(e,{i:["begin","case","fun","if","receive","try"]});case",":return D(e,{e:["begin","try","when","->",",","(","[","{","<<"]});case"->":return D(e,{r:["when"],m:["try","if","case","receive"]});case";":return D(e,{E:["case","fun","if","receive","try","when"]});case"catch":return D(e,{e:["try"]});case"of":return D(e,{e:["case"]});case"after":return D(e,{e:["receive","try"]});default:return e}}function D(e,t){for(var i in t)for(var r=e.length-1,n=t[i],a=r-1;a>-1;a--)if(k(e[a].token,n)){var o=e.slice(0,a);switch(i){case"m":return o.concat(e[a]).concat(e[r]);case"r":return o.concat(e[r]);case"i":return o;case"g":return o.concat(_("group"));case"E":return o.concat(e[a]);case"e":return o.concat(e[a])}}return"E"==i?[]:e}function $(i,r){var n,a=t.indentUnit,o=I(r),s=E(i,1),l=E(i,2);return i.in_string||i.in_atom?e.Pass:l?"when"==s.token?s.column+a:"when"===o&&"function"===l.type?l.indent+a:"("===o&&"fun"===s.token?s.column+3:"catch"===o&&(n=R(i,["try"]))?n.column:k(o,["end","after","of"])?(n=R(i,["begin","case","fun","if","receive","try"]),n?n.column:e.Pass):k(o,d)?(n=R(i,c),n?n.column:e.Pass):k(s.token,[",","|","||"])||k(o,[",","|","||"])?(n=M(i),n?n.column+n.token.length:a):"->"==s.token?k(l.token,["receive","case","if","try"])?l.column+a+a:l.column+a:k(s.token,c)?s.column+s.token.length:(n=L(i),F(n)?n.column+a:0):0}function I(e){var t=e.match(/,|[a-z]+|\}|\]|\)|>>|\|+|\(/);return F(t)&&0===t.index?t[0]:""}function M(e){var t=e.tokenStack.slice(0,-1),i=P(t,"type",["open_paren"]);return F(t[i])?t[i]:!1}function L(e){var t=e.tokenStack,i=P(t,"type",["open_paren","separator","keyword"]),r=P(t,"type",["operator"]);return F(i)&&F(r)&&r>i?t[i+1]:F(i)?t[i]:!1}function R(e,t){var i=e.tokenStack,r=P(i,"token",t);return F(i[r])?i[r]:!1}function P(e,t,i){for(var r=e.length-1;r>-1;r--)if(k(e[r][t],i))return r;return!1}function F(e){return e!==!1&&null!=e}var i=["-type","-spec","-export_type","-opaque"],r=["after","begin","catch","case","cond","end","fun","if","let","of","query","receive","try","when"],n=/[\->,;]/,a=["->",";",","],o=["and","andalso","band","bnot","bor","bsl","bsr","bxor","div","not","or","orelse","rem","xor"],s=/[\+\-\*\/<>=\|:!]/,l=["=","+","-","*","/",">",">=","<","=<","=:=","==","=/=","/=","||","<-","!"],u=/[<\(\[\{]/,c=["<<","(","[","{"],f=/[>\)\]\}]/,d=["}","]",")",">>"],h=["is_atom","is_binary","is_bitstring","is_boolean","is_float","is_function","is_integer","is_list","is_number","is_pid","is_port","is_record","is_reference","is_tuple","atom","binary","bitstring","boolean","function","integer","list","number","pid","port","record","reference","tuple"],p=["abs","adler32","adler32_combine","alive","apply","atom_to_binary","atom_to_list","binary_to_atom","binary_to_existing_atom","binary_to_list","binary_to_term","bit_size","bitstring_to_list","byte_size","check_process_code","contact_binary","crc32","crc32_combine","date","decode_packet","delete_module","disconnect_node","element","erase","exit","float","float_to_list","garbage_collect","get","get_keys","group_leader","halt","hd","integer_to_list","internal_bif","iolist_size","iolist_to_binary","is_alive","is_atom","is_binary","is_bitstring","is_boolean","is_float","is_function","is_integer","is_list","is_number","is_pid","is_port","is_process_alive","is_record","is_reference","is_tuple","length","link","list_to_atom","list_to_binary","list_to_bitstring","list_to_existing_atom","list_to_float","list_to_integer","list_to_pid","list_to_tuple","load_module","make_ref","module_loaded","monitor_node","node","node_link","node_unlink","nodes","notalive","now","open_port","pid_to_list","port_close","port_command","port_connect","port_control","pre_loaded","process_flag","process_info","processes","purge_module","put","register","registered","round","self","setelement","size","spawn","spawn_link","spawn_monitor","spawn_opt","split_binary","statistics","term_to_binary","time","throw","tl","trunc","tuple_size","tuple_to_list","unlink","unregister","whereis"],m=/[\w@Ø-ÞÀ-Öß-öø-ÿ]/,y=/[0-7]{1,3}|[bdefnrstv\\"']|\^[a-zA-Z]|x[0-9a-zA-Z]{2}|x{[0-9a-zA-Z]+}/;return{startState:function(){return{tokenStack:[],in_string:!1,in_atom:!1}},token:function(e,t){return g(e,t)},indent:function(e,t){return $(e,t)},lineComment:"%"}})});
