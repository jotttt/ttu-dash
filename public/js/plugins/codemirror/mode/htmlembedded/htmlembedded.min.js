!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../htmlmixed/htmlmixed")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../htmlmixed/htmlmixed"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("htmlembedded",function(t,i){function s(e,t){return e.match(r,!1)?(t.token=l,a.token(e,t.scriptState)):o.token(e,t.htmlState)}function l(e,t){return e.match(n,!1)?(t.token=s,o.token(e,t.htmlState)):a.token(e,t.scriptState)}var a,o,r=i.scriptStartRegex||/^<%/i,n=i.scriptEndRegex||/^%>/i;return{startState:function(){return a=a||e.getMode(t,i.scriptingModeSpec),o=o||e.getMode(t,"htmlmixed"),{token:i.startOpen?l:s,htmlState:e.startState(o),scriptState:e.startState(a)}},token:function(e,t){return t.token(e,t)},indent:function(e,t){return e.token==s?o.indent(e.htmlState,t):a.indent?a.indent(e.scriptState,t):void 0},copyState:function(t){return{token:t.token,htmlState:e.copyState(o,t.htmlState),scriptState:e.copyState(a,t.scriptState)}},innerMode:function(e){return e.token==l?{state:e.scriptState,mode:a}:{state:e.htmlState,mode:o}}}},"htmlmixed"),e.defineMIME("application/x-ejs",{name:"htmlembedded",scriptingModeSpec:"javascript"}),e.defineMIME("application/x-aspx",{name:"htmlembedded",scriptingModeSpec:"text/x-csharp"}),e.defineMIME("application/x-jsp",{name:"htmlembedded",scriptingModeSpec:"text/x-java"}),e.defineMIME("application/x-erb",{name:"htmlembedded",scriptingModeSpec:"ruby"})});
