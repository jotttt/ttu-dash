!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../javascript/javascript"),require("../css/css"),require("../htmlmixed/htmlmixed")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../javascript/javascript","../css/css","../htmlmixed/htmlmixed"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("jade",function(t){function l(){this.javaScriptLine=!1,this.javaScriptLineExcludesColon=!1,this.javaScriptArguments=!1,this.javaScriptArgumentsDepth=0,this.isInterpolating=!1,this.interpolationNesting=0,this.jsState=s.startState(),this.restOfLine="",this.isIncludeFiltered=!1,this.isEach=!1,this.lastTag="",this.scriptType="",this.isAttrs=!1,this.attrsNest=[],this.inAttributeName=!0,this.attributeIsType=!1,this.attrValue="",this.indentOf=1/0,this.indentToken="",this.innerMode=null,this.innerState=null,this.innerModeForLine=!1}function u(e,t){if(e.sol()&&(t.javaScriptLine=!1,t.javaScriptLineExcludesColon=!1),t.javaScriptLine){if(t.javaScriptLineExcludesColon&&":"===e.peek())return t.javaScriptLine=!1,void(t.javaScriptLineExcludesColon=!1);var i=s.token(e,t.jsState);return e.eol()&&(t.javaScriptLine=!1),i||!0}}function c(e,t){if(t.javaScriptArguments){if(0===t.javaScriptArgumentsDepth&&"("!==e.peek())return void(t.javaScriptArguments=!1);if("("===e.peek()?t.javaScriptArgumentsDepth++:")"===e.peek()&&t.javaScriptArgumentsDepth--,0===t.javaScriptArgumentsDepth)return void(t.javaScriptArguments=!1);var i=s.token(e,t.jsState);return i||!0}}function f(e){return e.match(/^yield\b/)?"keyword":void 0}function d(e){return e.match(/^(?:doctype) *([^\n]+)?/)?r:void 0}function h(e,t){return e.match("#{")?(t.isInterpolating=!0,t.interpolationNesting=0,"punctuation"):void 0}function p(e,t){if(t.isInterpolating){if("}"===e.peek()){if(t.interpolationNesting--,t.interpolationNesting<0)return e.next(),t.isInterpolating=!1,"puncutation"}else"{"===e.peek()&&t.interpolationNesting++;return s.token(e,t.jsState)||!0}}function m(e,t){return e.match(/^case\b/)?(t.javaScriptLine=!0,i):void 0}function y(e,t){return e.match(/^when\b/)?(t.javaScriptLine=!0,t.javaScriptLineExcludesColon=!0,i):void 0}function g(e){return e.match(/^default\b/)?i:void 0}function v(e,t){return e.match(/^extends?\b/)?(t.restOfLine="string",i):void 0}function b(e,t){return e.match(/^append\b/)?(t.restOfLine="variable",i):void 0}function w(e,t){return e.match(/^prepend\b/)?(t.restOfLine="variable",i):void 0}function x(e,t){return e.match(/^block\b *(?:(prepend|append)\b)?/)?(t.restOfLine="variable",i):void 0}function j(e,t){return e.match(/^include\b/)?(t.restOfLine="string",i):void 0}function k(e,t){return e.match(/^include:([a-zA-Z0-9\-]+)/,!1)&&e.match("include")?(t.isIncludeFiltered=!0,i):void 0}function Q(e,t){if(t.isIncludeFiltered){var i=M(e,t);return t.isIncludeFiltered=!1,t.restOfLine="string",i}}function T(e,t){return e.match(/^mixin\b/)?(t.javaScriptLine=!0,i):void 0}function S(e,t){return e.match(/^\+([-\w]+)/)?(e.match(/^\( *[-\w]+ *=/,!1)||(t.javaScriptArguments=!0,t.javaScriptArgumentsDepth=0),"variable"):e.match(/^\+#{/,!1)?(e.next(),t.mixinCallAfter=!0,h(e,t)):void 0}function C(e,t){return t.mixinCallAfter?(t.mixinCallAfter=!1,e.match(/^\( *[-\w]+ *=/,!1)||(t.javaScriptArguments=!0,t.javaScriptArgumentsDepth=0),!0):void 0}function _(e,t){return e.match(/^(if|unless|else if|else)\b/)?(t.javaScriptLine=!0,i):void 0}function E(e,t){return e.match(/^(- *)?(each|for)\b/)?(t.isEach=!0,i):void 0}function N(e,t){if(t.isEach){if(e.match(/^ in\b/))return t.javaScriptLine=!0,t.isEach=!1,i;if(e.sol()||e.eol())t.isEach=!1;else if(e.next()){for(;!e.match(/^ in\b/,!1)&&e.next(););return"variable"}}}function A(e,t){return e.match(/^while\b/)?(t.javaScriptLine=!0,i):void 0}function O(e,t){var i;return(i=e.match(/^(\w(?:[-:\w]*\w)?)\/?/))?(t.lastTag=i[1].toLowerCase(),"script"===t.lastTag&&(t.scriptType="application/javascript"),"tag"):void 0}function M(i,r){if(i.match(/^:([\w\-]+)/)){var n;return t&&t.innerModes&&(n=t.innerModes(i.current().substring(1))),n||(n=i.current().substring(1)),"string"==typeof n&&(n=e.getMode(t,n)),U(i,r,n),"atom"}}function D(e,t){return e.match(/^(!?=|-)/)?(t.javaScriptLine=!0,"punctuation"):void 0}function I(e){return e.match(/^#([\w-]+)/)?n:void 0}function $(e){return e.match(/^\.([\w-]+)/)?a:void 0}function L(e,t){return"("==e.peek()?(e.next(),t.isAttrs=!0,t.attrsNest=[],t.inAttributeName=!0,t.attrValue="",t.attributeIsType=!1,"punctuation"):void 0}function P(e,t){if(t.isAttrs){if(o[e.peek()]&&t.attrsNest.push(o[e.peek()]),t.attrsNest[t.attrsNest.length-1]===e.peek())t.attrsNest.pop();else if(e.eat(")"))return t.isAttrs=!1,"punctuation";if(t.inAttributeName&&e.match(/^[^=,\)!]+/))return("="===e.peek()||"!"===e.peek())&&(t.inAttributeName=!1,t.jsState=s.startState(),"script"===t.lastTag&&"type"===e.current().trim().toLowerCase()?t.attributeIsType=!0:t.attributeIsType=!1),"attribute";var i=s.token(e,t.jsState);if(t.attributeIsType&&"string"===i&&(t.scriptType=e.current().toString()),0===t.attrsNest.length&&("string"===i||"variable"===i||"keyword"===i))try{return Function("","var x "+t.attrValue.replace(/,\s*$/,"").replace(/^!/,"")),t.inAttributeName=!0,t.attrValue="",e.backUp(e.current().length),P(e,t)}catch(r){}return t.attrValue+=e.current(),i||!0}}function R(e,t){return e.match(/^&attributes\b/)?(t.javaScriptArguments=!0,t.javaScriptArgumentsDepth=0,"keyword"):void 0}function F(e){return e.sol()&&e.eatSpace()?"indent":void 0}function q(e,t){return e.match(/^ *\/\/(-)?([^\n]*)/)?(t.indentOf=e.indentation(),t.indentToken="comment","comment"):void 0}function z(e){return e.match(/^: */)?"colon":void 0}function H(e,t){return e.match(/^(?:\| ?| )([^\n]+)/)?"string":e.match(/^(<[^\n]*)/,!1)?(U(e,t,"htmlmixed"),t.innerModeForLine=!0,V(e,t,!0)):void 0}function B(e,t){if(e.eat(".")){var i=null;return"script"===t.lastTag&&-1!=t.scriptType.toLowerCase().indexOf("javascript")?i=t.scriptType.toLowerCase().replace(/"|'/g,""):"style"===t.lastTag&&(i="css"),U(e,t,i),"dot"}}function W(e){return e.next(),null}function U(i,r,n){n=e.mimeModes[n]||n,n=t.innerModes?t.innerModes(n)||n:n,n=e.mimeModes[n]||n,n=e.getMode(t,n),r.indentOf=i.indentation(),n&&"null"!==n.name?r.innerMode=n:r.indentToken="string"}function V(e,t,i){return e.indentation()>t.indentOf||t.innerModeForLine&&!e.sol()||i?t.innerMode?(t.innerState||(t.innerState=t.innerMode.startState?t.innerMode.startState(e.indentation()):{}),e.hideFirstChars(t.indentOf+2,function(){return t.innerMode.token(e,t.innerState)||!0})):(e.skipToEnd(),t.indentToken):void(e.sol()&&(t.indentOf=1/0,t.indentToken=null,t.innerMode=null,t.innerState=null))}function X(e,t){if(e.sol()&&(t.restOfLine=""),t.restOfLine){e.skipToEnd();var i=t.restOfLine;return t.restOfLine="",i}}function Y(){return new l}function G(e){return e.copy()}function K(e,t){var i=V(e,t)||X(e,t)||p(e,t)||Q(e,t)||N(e,t)||P(e,t)||u(e,t)||c(e,t)||C(e,t)||f(e,t)||d(e,t)||h(e,t)||m(e,t)||y(e,t)||g(e,t)||v(e,t)||b(e,t)||w(e,t)||x(e,t)||j(e,t)||k(e,t)||T(e,t)||S(e,t)||_(e,t)||E(e,t)||A(e,t)||O(e,t)||M(e,t)||D(e,t)||I(e,t)||$(e,t)||L(e,t)||R(e,t)||F(e,t)||H(e,t)||q(e,t)||z(e,t)||B(e,t)||W(e,t);return i===!0?null:i}var i="keyword",r="meta",n="builtin",a="qualifier",o={"{":"}","(":")","[":"]"},s=e.getMode(t,"javascript");return l.prototype.copy=function(){var t=new l;return t.javaScriptLine=this.javaScriptLine,t.javaScriptLineExcludesColon=this.javaScriptLineExcludesColon,t.javaScriptArguments=this.javaScriptArguments,t.javaScriptArgumentsDepth=this.javaScriptArgumentsDepth,t.isInterpolating=this.isInterpolating,t.interpolationNesting=this.intpolationNesting,t.jsState=e.copyState(s,this.jsState),t.innerMode=this.innerMode,this.innerMode&&this.innerState&&(t.innerState=e.copyState(this.innerMode,this.innerState)),t.restOfLine=this.restOfLine,t.isIncludeFiltered=this.isIncludeFiltered,t.isEach=this.isEach,t.lastTag=this.lastTag,t.scriptType=this.scriptType,t.isAttrs=this.isAttrs,t.attrsNest=this.attrsNest.slice(),t.inAttributeName=this.inAttributeName,t.attributeIsType=this.attributeIsType,t.attrValue=this.attrValue,t.indentOf=this.indentOf,t.indentToken=this.indentToken,t.innerModeForLine=this.innerModeForLine,t},{startState:Y,copyState:G,token:K}}),e.defineMIME("text/x-jade","jade")});
