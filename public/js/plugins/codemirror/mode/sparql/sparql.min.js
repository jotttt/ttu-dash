!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("sparql",function(e){function i(e){return new RegExp("^(?:"+e.join("|")+")$","i")}function s(e,t){var i=e.next();if(r=null,"$"==i||"?"==i)return e.match(/^[\w\d]*/),"variable-2";if("<"!=i||e.match(/^[\s\u00a0=]/,!1)){if('"'==i||"'"==i)return t.tokenize=l(i),t.tokenize(e,t);if(/[{}\(\),\.;\[\]]/.test(i))return r=i,null;if("#"==i)return e.skipToEnd(),"comment";if(o.test(i))return e.eatWhile(o),null;if(":"==i)return e.eatWhile(/[\w\d\._\-]/),"atom";if(e.eatWhile(/[_\w\d]/),e.eat(":"))return e.eatWhile(/[\w\d_\-]/),"atom";var s=e.current();return n.test(s)?null:a.test(s)?"keyword":"variable"}return e.match(/^[^\s\u00a0>]*>?/),"atom"}function l(e){return function(t,r){for(var n,i=!1;null!=(n=t.next());){if(n==e&&!i){r.tokenize=s;break}i=!i&&"\\"==n}return"string"}}function u(e,t,r){e.context={prev:e.context,indent:e.indent,col:r,type:t}}function c(e){e.indent=e.context.indent,e.context=e.context.prev}var r,t=e.indentUnit,n=i(["str","lang","langmatches","datatype","bound","sameterm","isiri","isuri","isblank","isliteral","a"]),a=i(["base","prefix","select","distinct","reduced","construct","describe","ask","from","named","where","order","limit","offset","filter","optional","graph","by","asc","desc","as","having","undef","values","group","minus","in","not","service","silent","using","insert","delete","union","data","copy","to","move","add","create","drop","clear","load"]),o=/[*+\-<>=&|]/;return{startState:function(){return{tokenize:s,context:null,indent:0,col:0}},token:function(e,t){if(e.sol()&&(t.context&&null==t.context.align&&(t.context.align=!1),t.indent=e.indentation()),e.eatSpace())return null;var i=t.tokenize(e,t);if("comment"!=i&&t.context&&null==t.context.align&&"pattern"!=t.context.type&&(t.context.align=!0),"("==r)u(t,")",e.column());else if("["==r)u(t,"]",e.column());else if("{"==r)u(t,"}",e.column());else if(/[\]\}\)]/.test(r)){for(;t.context&&"pattern"==t.context.type;)c(t);t.context&&r==t.context.type&&c(t)}else"."==r&&t.context&&"pattern"==t.context.type?c(t):/atom|string|variable/.test(i)&&t.context&&(/[\}\]]/.test(t.context.type)?u(t,"pattern",e.column()):"pattern"!=t.context.type||t.context.align||(t.context.align=!0,t.context.col=e.column()));return i},indent:function(e,r){var i=r&&r.charAt(0),n=e.context;if(/[\]\}]/.test(i))for(;n&&"pattern"==n.type;)n=n.prev;var a=n&&i==n.type;return n?"pattern"==n.type?n.col:n.align?n.col+(a?0:1):n.indent+(a?0:t):0}}}),e.defineMIME("application/x-sparql-query","sparql")});
