!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("tiddlywiki",function(){function p(e,t,r){return t.tokenize=r,r(e,t)}function y(e,t,r){return m=e,g=r,t}function v(t,d){var m,h=t.sol();if(d.block=!1,m=t.peek(),h&&/[<\/\*{}\-]/.test(m)){if(t.match(f))return d.block=!0,p(t,d,w);if(t.match(o))return y("quote","quote");if(t.match(n)||t.match(a))return y("code","comment");if(t.match(s)||t.match(l)||t.match(u)||t.match(c))return y("code","comment");if(t.match(i))return y("hr","hr")}if(m=t.next(),h&&/[\/\*!#;:>|]/.test(m)){if("!"==m)return t.skipToEnd(),y("header","header");if("*"==m)return t.eatWhile("*"),y("list","comment");if("#"==m)return t.eatWhile("#"),y("list","comment");if(";"==m)return t.eatWhile(";"),y("list","comment");if(":"==m)return t.eatWhile(":"),y("list","comment");if(">"==m)return t.eatWhile(">"),y("quote","quote");if("|"==m)return y("table","header")}if("{"==m&&t.match(/\{\{/))return p(t,d,w);if(/[hf]/i.test(m)&&/[ti]/i.test(t.peek())&&t.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i))return y("link","link");if('"'==m)return y("string","string");if("~"==m)return y("text","brace");if(/[\[\]]/.test(m)&&t.peek()==m)return t.next(),y("brace","brace");if("@"==m)return t.eatWhile(r),y("link","link");if(/\d/.test(m))return t.eatWhile(/\d/),y("number","number");if("/"==m){if(t.eat("%"))return p(t,d,b);if(t.eat("/"))return p(t,d,k)}if("_"==m&&t.eat("_"))return p(t,d,_);if("-"==m&&t.eat("-")){if(" "!=t.peek())return p(t,d,j);if(" "==t.peek())return y("text","brace")}if("'"==m&&t.eat("'"))return p(t,d,x);if("<"!=m)return y(m);if(t.eat("<"))return p(t,d,S);t.eatWhile(/[\w\$_]/);var g=t.current(),v=e.propertyIsEnumerable(g)&&e[g];return v?y(v.type,v.style,g):y("text",null,g)}function b(e,t){for(var i,r=!1;i=e.next();){if("/"==i&&r){t.tokenize=v;break}r="%"==i}return y("comment","comment")}function x(e,t){for(var i,r=!1;i=e.next();){if("'"==i&&r){t.tokenize=v;break}r="'"==i}return y("text","strong")}function w(e,t){var r,i=t.block;return i&&e.current()?y("code","comment"):!i&&e.match(h)?(t.tokenize=v,y("code","comment")):i&&e.sol()&&e.match(d)?(t.tokenize=v,y("code","comment")):(r=e.next(),i?y("code","comment"):y("code","comment"))}function k(e,t){for(var i,r=!1;i=e.next();){if("/"==i&&r){t.tokenize=v;break}r="/"==i}return y("text","em")}function _(e,t){for(var i,r=!1;i=e.next();){if("_"==i&&r){t.tokenize=v;break}r="_"==i}return y("text","underlined")}function j(e,t){for(var i,r=!1;i=e.next();){if("-"==i&&r){t.tokenize=v;break}r="-"==i}return y("text","strikethrough")}function S(e,r){var i,n,a;return"<<"==e.current()?y("brace","macro"):(i=e.next())?">"==i&&">"==e.peek()?(e.next(),r.tokenize=v,y("brace","macro")):(e.eatWhile(/[\w\$_]/),n=e.current(),a=t.propertyIsEnumerable(n)&&t[n],a?y(a.type,a.style,n):y("macro",null,n)):(r.tokenize=v,y(i))}var m,g,e={},t=function(){function e(e){return{type:e,style:"macro"}}return{allTags:e("allTags"),closeAll:e("closeAll"),list:e("list"),newJournal:e("newJournal"),newTiddler:e("newTiddler"),permaview:e("permaview"),saveChanges:e("saveChanges"),search:e("search"),slider:e("slider"),tabs:e("tabs"),tag:e("tag"),tagging:e("tagging"),tags:e("tags"),tiddler:e("tiddler"),timeline:e("timeline"),today:e("today"),version:e("version"),option:e("option"),"with":e("with"),filter:e("filter")}}(),r=/[\w_\-]/i,i=/^\-\-\-\-+$/,n=/^\/\*\*\*$/,a=/^\*\*\*\/$/,o=/^<<<$/,s=/^\/\/\{\{\{$/,l=/^\/\/\}\}\}$/,u=/^<!--\{\{\{-->$/,c=/^<!--\}\}\}-->$/,f=/^\{\{\{$/,d=/^\}\}\}$/,h=/.*?\}\}\}/;return{startState:function(){return{tokenize:v,indented:0,level:0}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t);return r},electricChars:""}}),e.defineMIME("text/x-tiddlywiki","tiddlywiki")});
