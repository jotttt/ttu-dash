!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(e){"use strict";e.defineMode("xquery",function(){function i(e,i,n){return t=e,r=n,i}function n(e,t,r){return t.tokenize=r,r(e,t)}function a(t,r){var a=t.next(),c=!1,m=v(t);if("<"==a){if(t.match("!--",!0))return n(t,r,f);if(t.match("![CDATA",!1))return r.tokenize=d,i("tag","tag");if(t.match("?",!1))return n(t,r,p);var y=t.eat("/");t.eatSpace();for(var w,b="";w=t.eat(/[^\s\u00a0=<>\"\'\/?]/);)b+=w;return n(t,r,u(b,y))}if("{"==a)return x(r,{type:"codeblock"}),i("",null);if("}"==a)return k(r),i("",null);if(h(r))return">"==a?i("tag","tag"):"/"==a&&t.eat(">")?(k(r),i("tag","tag")):i("word","variable");if(/\d/.test(a))return t.match(/^\d*(?:\.\d*)?(?:E[+\-]?\d+)?/),i("number","atom");if("("===a&&t.eat(":"))return x(r,{type:"comment"}),n(t,r,o);if(m||'"'!==a&&"'"!==a){if("$"===a)return n(t,r,l);if(":"===a&&t.eat("="))return i("operator","keyword");if("("===a)return x(r,{type:"paren"}),i("",null);if(")"===a)return k(r),i("",null);if("["===a)return x(r,{type:"bracket"}),i("",null);if("]"===a)return k(r),i("",null);var _=e.propertyIsEnumerable(a)&&e[a];if(m&&'"'===a)for(;'"'!==t.next(););if(m&&"'"===a)for(;"'"!==t.next(););_||t.eatWhile(/[\w\$_-]/);var j=t.eat(":");!t.eat(":")&&j&&t.eatWhile(/[\w\$_-]/),t.match(/^[ \t]*\(/,!1)&&(c=!0);var S=t.current();return _=e.propertyIsEnumerable(S)&&e[S],c&&!_&&(_={type:"function_call",style:"variable def"}),g(r)?(k(r),i("word","variable",S)):(("element"==S||"attribute"==S||"axis_specifier"==_.type)&&x(r,{type:"xmlconstructor"}),_?i(_.type,_.style,S):i("word","variable",S))}return n(t,r,s(a))}function o(e,t){for(var o,r=!1,n=!1,a=0;o=e.next();){if(")"==o&&r){if(!(a>0)){k(t);break}a--}else":"==o&&n&&a++;r=":"==o,n="("==o}return i("comment","comment")}function s(e,t){return function(r,n){var o;if(y(n)&&r.current()==e)return k(n),t&&(n.tokenize=t),i("string","string");if(x(n,{type:"string",name:e,tokenize:s(e,t)}),r.match("{",!1)&&m(n))return n.tokenize=a,i("string","string");for(;o=r.next();){if(o==e){k(n),t&&(n.tokenize=t);break}if(r.match("{",!1)&&m(n))return n.tokenize=a,i("string","string")}return i("string","string")}}function l(e,t){var r=/[\w\$_-]/;if(e.eat('"')){for(;'"'!==e.next(););e.eat(":")}else e.eatWhile(r),e.match(":=",!1)||e.eat(":");return e.eatWhile(r),t.tokenize=a,i("variable","variable")}function u(e,t){return function(r,n){return r.eatSpace(),t&&r.eat(">")?(k(n),n.tokenize=a,i("tag","tag")):(r.eat("/")||x(n,{type:"tag",name:e,tokenize:a}),r.eat(">")?(n.tokenize=a,i("tag","tag")):(n.tokenize=c,i("tag","tag")))}}function c(e,t){var r=e.next();return"/"==r&&e.eat(">")?(m(t)&&k(t),h(t)&&k(t),i("tag","tag")):">"==r?(m(t)&&k(t),i("tag","tag")):"="==r?i("",null):'"'==r||"'"==r?n(e,t,s(r,c)):(m(t)||x(t,{type:"attribute",tokenize:c}),e.eat(/[a-zA-Z_:]/),e.eatWhile(/[-a-zA-Z0-9_:.]/),e.eatSpace(),(e.match(">",!1)||e.match("/",!1))&&(k(t),t.tokenize=a),i("attribute","attribute"))}function f(e,t){for(var r;r=e.next();)if("-"==r&&e.match("->",!0))return t.tokenize=a,i("comment","comment")}function d(e,t){for(var r;r=e.next();)if("]"==r&&e.match("]",!0))return t.tokenize=a,i("comment","comment")}function p(e,t){for(var r;r=e.next();)if("?"==r&&e.match(">",!0))return t.tokenize=a,i("comment","comment meta")}function h(e){return b(e,"tag")}function m(e){return b(e,"attribute")}function g(e){return b(e,"xmlconstructor")}function y(e){return b(e,"string")}function v(e){return'"'===e.current()?e.match(/^[^\"]+\"\:/,!1):"'"===e.current()?e.match(/^[^\"]+\'\:/,!1):!1}function b(e,t){return e.stack.length&&e.stack[e.stack.length-1].type==t}function x(e,t){e.stack.push(t)}function k(e){e.stack.pop();var t=e.stack.length&&e.stack[e.stack.length-1].tokenize;e.tokenize=t||a}var t,r,e=function(){function e(e){return{type:e,style:"keyword"}}for(var t=e("keyword a"),r=e("keyword b"),i=e("keyword c"),n=e("operator"),a={type:"atom",style:"atom"},o={type:"punctuation",style:null},s={type:"axis_specifier",style:"qualifier"},l={"if":t,"switch":t,"while":t,"for":t,"else":r,then:r,"try":r,"finally":r,"catch":r,element:i,attribute:i,let:i,"implements":i,"import":i,module:i,namespace:i,"return":i,"super":i,"this":i,"throws":i,where:i,"private":i,",":o,"null":a,"fn:false()":a,"fn:true()":a},u=["after","ancestor","ancestor-or-self","and","as","ascending","assert","attribute","before","by","case","cast","child","comment","declare","default","define","descendant","descendant-or-self","descending","document","document-node","element","else","eq","every","except","external","following","following-sibling","follows","for","function","if","import","in","instance","intersect","item","let","module","namespace","node","node","of","only","or","order","parent","precedes","preceding","preceding-sibling","processing-instruction","ref","return","returns","satisfies","schema","schema-element","self","some","sortby","stable","text","then","to","treat","typeswitch","union","variable","version","where","xquery","empty-sequence"],c=0,f=u.length;f>c;c++)l[u[c]]=e(u[c]);for(var d=["xs:string","xs:float","xs:decimal","xs:double","xs:integer","xs:boolean","xs:date","xs:dateTime","xs:time","xs:duration","xs:dayTimeDuration","xs:time","xs:yearMonthDuration","numeric","xs:hexBinary","xs:base64Binary","xs:anyURI","xs:QName","xs:byte","xs:boolean","xs:anyURI","xf:yearMonthDuration"],c=0,f=d.length;f>c;c++)l[d[c]]=a;for(var p=["eq","ne","lt","le","gt","ge",":=","=",">",">=","<","<=",".","|","?","and","or","div","idiv","mod","*","/","+","-"],c=0,f=p.length;f>c;c++)l[p[c]]=n;for(var h=["self::","attribute::","child::","descendant::","descendant-or-self::","parent::","ancestor::","ancestor-or-self::","following::","preceding::","following-sibling::","preceding-sibling::"],c=0,f=h.length;f>c;c++)l[h[c]]=s;return l}();return{startState:function(){return{tokenize:a,cc:[],stack:[]}},token:function(e,t){if(e.eatSpace())return null;var r=t.tokenize(e,t);return r},blockCommentStart:"(:",blockCommentEnd:":)"}}),e.defineMIME("application/xquery","xquery")});
